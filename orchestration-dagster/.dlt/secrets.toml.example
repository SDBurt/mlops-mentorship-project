# dlt secrets configuration template
# Copy this file to secrets.toml and fill in your credentials
# IMPORTANT: secrets.toml is gitignored - never commit actual credentials!

# Configuration Path Structure:
# dlt uses the path: sources.source.{source_name}
# - "sources" is the top-level section for all dlt sources
# - "source" comes from the function naming pattern (reddit_source function)
# - "reddit" is the name specified in @dlt.source(name="reddit")
# Therefore, use [sources.source.reddit] section below

# Reddit API Configuration
# To obtain credentials:
# 1. Visit https://www.reddit.com/prefs/apps
# 2. Click "create app" or "create another app"
# 3. Choose "script" as the app type
# 4. Fill in:
#    - name: Your app name (e.g., "lakehouse-reddit-ingestion")
#    - description: Brief description of your app
#    - redirect uri: http://localhost:8080 (required but not used for script apps)
# 5. After creating the app:
#    - client_id: Found directly under the app name (looks like: XxXxXxXxXxXxXx)
#    - client_secret: Found in the "secret" field in the app info
#
# User-Agent Format:
# - Must follow: <platform>:<app_id>:<version> (by /u/<reddit_username>)
# - Example: python:lakehouse-dlt:v1.0.0 (by /u/myusername)
# - Reddit requires unique and descriptive user agents
# - Default/generic user agents (like "Python/urllib") are rate-limited

[sources.source.reddit]
# Reddit API credentials (required)
client_id = "YOUR_CLIENT_ID_HERE"
client_secret = "YOUR_CLIENT_SECRET_HERE"
user_agent = "python:lakehouse-dlt:v1.0.0 (by /u/YOUR_REDDIT_USERNAME)"

# Configuration (optional - can be overridden when calling the source)
subreddit = "worldnews"        # Default subreddit to extract data from
time_filter = "day"            # Time filter for top posts: all, year, month, week, day, hour
limit = 10                     # Max posts/comments per request (Reddit API limit)

# Destination configuration (filesystem with Iceberg table format)
# Resources use table_format="iceberg" to write Iceberg tables to S3
[destination.filesystem]
bucket_url = "s3://lakehouse/iceberg"  # MinIO bucket and prefix for Iceberg tables

[destination.filesystem.credentials]
aws_access_key_id = "admin"  # MinIO root user (change for production)
aws_secret_access_key = "minio123"  # MinIO root password (change for production)
endpoint_url = "http://localhost:9000"  # For local dev with port-forward; use http://minio:9000 in K8s
region_name = "us-east-1"  # Standard AWS region for compatibility

[destination.filesystem.credentials.client_kwargs]
use_path_style_endpoint = true  # Required for MinIO (path-style URLs)
use_ssl = false  # MinIO doesn't use SSL on internal endpoints
