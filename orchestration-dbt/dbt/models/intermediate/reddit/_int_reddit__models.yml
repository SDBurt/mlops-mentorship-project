version: 2

models:
  # ==========================================================================
  # Intermediate Model: Reddit Author Statistics
  # ==========================================================================
  - name: int_reddit_author_stats
    description: |
      Intermediate model aggregating author metrics from posts and comments.
      Calculates engagement scores, activity counts, and reputation metrics.
      Used as input for dim_author dimension table.
    config:
      materialized: ephemeral
      tags: ['intermediate', 'reddit', 'authors']
    columns:
      - name: author
        description: "Reddit username (natural key)"
      - name: author_fullname
        description: "Full Reddit author ID (natural key)"
      - name: total_posts
        description: "Total number of posts by author"
      - name: total_comments
        description: "Total number of comments by author"
      - name: total_activity
        description: "Total posts + comments"
      - name: total_score
        description: "Combined score from posts and comments"
      - name: reputation_score
        description: "Calculated reputation score (for ML features)"

  # ==========================================================================
  # Intermediate Model: Reddit Post Metrics
  # ==========================================================================
  - name: int_reddit_post_metrics
    description: |
      Intermediate model calculating derived engagement metrics for posts.
      Includes temporal features, content features, and ML-ready engagement scores.
      Used as input for fct_posts fact table.
    config:
      materialized: ephemeral
      tags: ['intermediate', 'reddit', 'posts', 'metrics']
    columns:
      - name: post_id
        description: "Reddit post ID (natural key)"
      - name: engagement_score
        description: "Derived engagement metric (for ML features)"
      - name: virality_ratio
        description: "Comments per score (high = viral discussion)"
      - name: controversy_score
        description: "Controversy indicator (low upvote ratio + high engagement)"
      - name: quality_score
        description: "Quality indicator (upvote ratio * log(score))"
      - name: hour_of_day
        description: "Hour when post was created (0-23)"
      - name: day_of_week
        description: "Day of week (1=Monday, 7=Sunday)"
      - name: is_weekend
        description: "True if post was created on weekend"
